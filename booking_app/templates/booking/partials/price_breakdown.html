<!-- DEBUG: is_available = {{ is_available }} -->
{% if is_available %}
<ul class="list-group list-group-flush mb-3 bg-transparent">
    <li class="list-group-item d-flex justify-content-between bg-transparent text-white border-bottom border-secondary">
        <span>Base Price</span>
        <span>₹{{ breakdown.base }}</span>
    </li>
    {% if breakdown.court_premium > 0 %}
    <li class="list-group-item d-flex justify-content-between bg-transparent text-info border-bottom border-secondary">
        <span><i class="fa-solid fa-warehouse me-2"></i>Indoor Premium</span>
        <span>+₹{{ breakdown.court_premium }}</span>
    </li>
    {% endif %}
    {% if breakdown.peak_surcharge > 0 %}
    <li
        class="list-group-item d-flex justify-content-between bg-transparent text-danger border-bottom border-secondary">
        <span><i class="fa-solid fa-fire me-2"></i>Peak Hours</span>
        <span>+₹{{ breakdown.peak_surcharge }}</span>
    </li>
    {% endif %}
    {% if breakdown.weekend_surcharge > 0 %}
    <li
        class="list-group-item d-flex justify-content-between bg-transparent text-warning border-bottom border-secondary">
        <span><i class="fa-solid fa-calendar-week me-2"></i>Weekend Surcharge</span>
        <span>+₹{{ breakdown.weekend_surcharge }}</span>
    </li>
    {% endif %}
    {% if breakdown.equipment > 0 %}
    <li class="list-group-item d-flex justify-content-between bg-transparent text-white border-bottom border-secondary">
        <span><i class="fa-solid fa-shirt me-2"></i>Equipment</span>
        <span>+₹{{ breakdown.equipment }}</span>
    </li>
    {% endif %}
    {% if breakdown.coach > 0 %}
    <li class="list-group-item d-flex justify-content-between bg-transparent text-white border-bottom border-secondary">
        <span><i class="fa-solid fa-user-tie me-2"></i>Coach</span>
        <span>+₹{{ breakdown.coach }}</span>
    </li>
    {% endif %}
    <li class="list-group-item d-flex justify-content-between bg-transparent text-white fw-bold fs-4 mt-2 border-0">
        <span>Total</span>
        <span class="text-success">₹{{ breakdown.total }}</span>
    </li>
</ul>

<!-- Enable Main Button -->
<script>
    document.getElementById('submit-btn').disabled = false;
    document.getElementById('submit-btn').innerHTML = 'Confirm Booking <i class="fa-solid fa-check-circle ms-2"></i>';
    document.getElementById('submit-btn').classList.remove('btn-secondary');
    document.getElementById('submit-btn').classList.add('btn-success');
    // Remove waitlist form if exists
    const wlForm = document.getElementById('waitlist-form-container');
    if (wlForm) wlForm.innerHTML = '';
</script>

{% else %}
<div class="alert alert-warning border-0 text-center">
    <i class="fa-solid fa-triangle-exclamation fa-2x mb-3"></i>
    <h5 class="fw-bold">Slot Unavailable</h5>
    <p class="mb-0">This slot is already booked.</p>
</div>

<!-- Disable Main Button and Show Waitlist Option -->
<script>
    document.getElementById('submit-btn').disabled = true;
    document.getElementById('submit-btn').innerHTML = 'Slot Unavailable';
    document.getElementById('submit-btn').classList.remove('btn-success');
    document.getElementById('submit-btn').classList.add('btn-secondary');
</script>

<div id="waitlist-form-container" class="mt-3">
    <form action="{% url 'join_waitlist' %}" method="post">
        {% csrf_token %}
        <input type="hidden" name="date" value="{{ date }}">
        <input type="hidden" name="time" value="{{ time }}">
        <input type="hidden" name="court" value="{{ court_id }}">
        <button type="submit" class="btn btn-warning w-100 fw-bold">
            <i class="fa-solid fa-clock me-2"></i> Join Waitlist
        </button>
    </form>
</div>
{% endif %}